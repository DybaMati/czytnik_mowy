<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nasluchiwanie cyfr - ciagle</title>
<style>
body { font-family: Arial; padding: 20px; }
button { font-size: 18px; padding: 10px 20px; margin-top: 10px; }
table { border-collapse: collapse; margin-top: 20px; width: 100%; }
th, td { border: 1px solid #000; padding: 10px; font-size: 22px; text-align: center; }
</style>
</head>
<body>

<h2>Nasluchiwanie cyfr - ciagle</h2>
<button id="start">ðŸŽ™ Start / Stop</button>
<p id="info">Kliknij przycisk, aby rozpoczÄ…Ä‡ nasÅ‚uchiwanie.</p>

<table id="table">
<tr><th>#</th><th>Numer</th></tr>
</table>

<script>
const map = { zero:"0", jeden:"1", dwa:"2", trzy:"3", cztery:"4", piec:"5", szesc:"6", siedem:"7", osiem:"8", dziewiec:"9" };
let counter = 1;
const table = document.getElementById("table");
const info = document.getElementById("info");

const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
if(!SpeechRecognition){
    info.textContent = "Twoja przeglÄ…darka nie wspiera rozpoznawania mowy. UÅ¼yj Safari na iPhone lub Chrome/Safari na komputerze.";
} else {
    const recognition = new SpeechRecognition();
    recognition.lang = "pl-PL";
    recognition.continuous = true;  // <- ciagÅ‚e nasluchiwanie
    recognition.interimResults = false;

    let listening = false;

    document.getElementById("start").onclick = () => {
        if(!listening){
            recognition.start();
            listening = true;
            info.textContent = "Nagrywanieâ€¦ mow cyfry!";
            console.log("RozpoczÄ™to nasÅ‚uchiwanie");
        } else {
            recognition.stop();
            listening = false;
            info.textContent = "NasÅ‚uchiwanie zatrzymane.";
            console.log("Zatrzymano nasÅ‚uchiwanie");
        }
    };

    recognition.onresult = (event) => {
        const text = event.results[event.results.length - 1][0].transcript.toLowerCase();
        console.log("Rozpoznano:", text);
        let digits = [];
        text.split(/\s+/).forEach(word => { if(map[word]) digits.push(map[word]); });
        digits = digits.slice(0,4);
        while(digits.length < 4) digits.push("-");
        const row = table.insertRow();
        row.insertCell().textContent = counter++;
        row.insertCell().textContent = digits.join("");
        console.log("Dodano wiersz:", digits.join(""));
    };

    recognition.onerror = (e) => {
        console.log("BÅ‚Ä…d rozpoznawania mowy:", e.error);
        info.textContent = "BÅ‚Ä…d: " + e.error;
    };

    recognition.onend = () => {
        console.log("Recognition ended");
        if(listening){
            console.log("Restartujemy nasÅ‚uchiwanie");
            recognition.start();  // <- kontynuacja nasÅ‚uchiwania automatycznie
        }
    };
}
</script>

</body>gggggffff
</html>
